{% extends 'base.html' %}
{% block content %}
<!-- Product Details Section -->
<div class="container my-5">
  <div class="card product-detail-card shadow-lg">
    <div class="row g-0 align-items-center">

      <!-- Product Image -->
      <div class="col-md-5">
        <div class="product-image-wrapper">
          <img src="{{ product.image.url }}" class="img-fluid rounded-start product-img" alt="{{ product.name }}">
          {% if product.is_sale %}
            <span class="badge bg-danger sale-badge">Sale</span>
          {% endif %}
        </div>
      </div>

      <!-- Product Info -->
      <div class="col-md-7">
        <div class="card-body text-center p-5">
          <h2 class="product-title">{{ product.name }}</h2>
          <p class="product-description">{{ product.description }}</p>

          {% if product.is_sale %}
            <p class="product-price">
              <span class="text-muted text-decoration-line-through">${{ product.price }}</span>
              <span class="fw-bold text-success ms-2">${{ product.sale_price }}</span>
            </p>
          {% else %}
            <p class="product-price fw-bold">${{ product.price }}</p>
          {% endif %}

          <!-- Actions -->
          <div class="mt-4">
            <a href="{% url 'home' %}" class="btn btn-outline-light rounded-pill px-4 me-2">üè† Home</a>
            <button type="button" value="{{ product.id }}" class="btn btn-primary rounded-pill px-4 add-cart">üõí Add To Cart</button>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<!-- Custom Styles -->
<style>
  /* Product Card Dark Theme */
  .product-detail-card {
    background-color: #1e1e1e;
    border: none;
    border-radius: 18px;
    overflow: hidden;
    color: #eaeaea;
  }

  /* Product Image */
  .product-image-wrapper {
    position: relative;
    overflow: hidden;
    border-radius: 18px 0 0 18px;
  }
  .product-img {
    width: 100%;
    height: auto;
    transition: transform 0.4s ease;
  }
  .product-image-wrapper:hover .product-img {
    transform: scale(1.08);
  }

  /* Sale Badge */
  .sale-badge {
    position: absolute;
    top: 15px;
    left: 15px;
    font-size: 0.9rem;
    padding: 6px 12px;
    border-radius: 30px;
  }

  /* Product Info */
  .product-title {
    font-family: 'Cinzel Decorative', cursive;
    font-size: 2rem;
    margin-bottom: 15px;
  }
  .product-description {
    font-family: 'Inter', sans-serif;
    font-size: 1rem;
    opacity: 0.85;
    margin-bottom: 20px;
  }
  .product-price {
    font-size: 1.4rem;
  }

  /* Buttons */
  .btn-outline-light {
    border: 2px solid #eaeaea;
    color: #eaeaea;
    transition: all 0.3s ease;
  }
  .btn-outline-light:hover {
    background-color: #0d6efd;
    border-color: #0d6efd;
    color: #fff;
    transform: scale(1.05);
  }
  .btn-primary {
    background: linear-gradient(135deg, #6a11cb, #2575fc);
    border: none;
    transition: all 0.3s ease;
  }
  .btn-primary:hover {
    transform: scale(1.05);
    background: linear-gradient(135deg, #2575fc, #6a11cb);
  }
</style>

<!-- jQuery (if not in base.html) -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
$(document).ready(function() {
    // Add to Cart button click
    $(document).on('click', '.add-cart', function(e) {
        e.preventDefault();

        var productId = $(this).val();

        $.ajax({
            type: 'POST',
            url: "{% url 'cart_add' %}",
            data: {
                product_id: productId,
                csrfmiddlewaretoken: '{{ csrf_token }}',
                action: 'post'
            },
            success: function(response) {
                console.log(response);
                alert('‚úÖ Product added to cart!');
            },
            error: function(xhr, errmsg, err) {
                console.error(xhr.status + ": " + xhr.responseText);
                alert('‚ùå An error occurred. Please try again.');
            }
        });
    });
});
</script>
{% endblock %}
